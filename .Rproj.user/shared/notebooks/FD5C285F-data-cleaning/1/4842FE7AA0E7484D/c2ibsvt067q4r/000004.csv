"0","#create in store inv"
"0","inventory%>%"
"0","  rename(WMT = `Item Nbr`)%>%"
"0","  select(WMT, `Curr Str On Hand Qty`)->store_oh"
"0","#check for missing SKUs"
"0","missingSkus <- c()"
"0","for(line in store_oh$WMT){"
"0","  if(line %in% store_inv_sku$WMT){"
"0","    #nothing"
"0","  }else{"
"0","    missingSkus <- c(missingSkus, line)"
"0","    newSku <- data.frame()"
"0","  }"
"0","}"
"0","#"
"0","for (value in missingSkus) {"
"0","    store_oh%>%"
"0","        filter(WMT == value)%>%"
"0","        dplyr::select(WMT)-> skuSub"
"0","    newSku <- bind_rows(newSku, skuSub)"
"0","}"
"0",""
"0","if(length(missingSkus) > 0){"
"0","  write.xlsx(newSku, here(""data"", ""newStoreSKU.xlsx"", sep = """"), overwrite = TRUE)"
"0","  {stop(length(missingSkus), "" new SKU values! Copy new SKUs to store_inv_sku.xlsx and rerun code"")}"
"0","}"
"0",""
"0","#merge with WMT# inv reference data"
"0","store_inv <- left_join(store_inv_sku, store_oh, by = ""WMT"")"
"0","#Replace NA with 0"
"0","store_inv$`Curr Str On Hand Qty`[is.na(store_inv$`Curr Str On Hand Qty`)] <- 0"
"0",""
"0","#repeat for online inventory"
"0","online%>%"
"0","  rename(WMT = `WM_ITEM_NUMBER (Dotcom)`)%>%"
"0","  rename(`Curr Str On Hand Qty` = OH)%>%"
"0","  select(WMT, `Curr Str On Hand Qty`)->online_oh"
"0","online_oh$WMT <- as.numeric(online_oh$WMT)"
"2","NAs introduced by coercion"
"0","#check for missing SKUs"
"0","missingSkus <- c()"
"0","for(line in online_oh$WMT){"
"0","  if(line %in% online_inv_sku$WMT){"
"0","    #nothing"
"0","  }else{"
"0","    missingSkus <- c(missingSkus, line)"
"0","    newSku <- data.frame()"
"0","  }"
"0","}"
"0","#"
"0","for (value in missingSkus) {"
"0","    online_oh%>%"
"0","        filter(WMT == value)%>%"
"0","        dplyr::select(WMT)-> skuSub"
"0","    newSku <- bind_rows(newSku, skuSub)"
"0","}"
"0",""
"0","if(length(missingSkus) > 0){"
"0","  write.xlsx(newSku, here(""data"", ""newInvSKU.xlsx"", sep = """"), overwrite = TRUE)"
"0","  {stop(length(missingSkus), "" new SKU values! Copy new SKUs to online_inv_sku.xlsx from newInvSKU.xlsx and rerun code"")}"
"0","}"
"0",""
"0","online_inv <- left_join(online_inv_sku, online_oh, by = ""WMT"")"
"0",""
"0","online_inv$`Curr Str On Hand Qty`[is.na(online_inv$`Curr Str On Hand Qty`)] <- 0"
"0","#merge data"
"0","inv_tot <- bind_rows(store_inv, online_inv)"
