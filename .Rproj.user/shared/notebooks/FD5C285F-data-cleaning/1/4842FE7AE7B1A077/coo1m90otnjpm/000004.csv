"0","#load online data"
"0","online <- read_excel(here(""data"", params$year, month, paste(""Week"", params$wk, sep = """"), ""online.xlsx""))"
"0","#add POS Sales column"
"0","online <- mutate(online, `POS Sales` = `Average Unit Retail`*`Net Units`)"
"0",""
"0","#Rename columns, mutate columns to perform calculations"
"0","online%>%"
"0","  mutate(WeekStart = this_week$WeekStart)%>%"
"0","  mutate(WeekEnd = this_week$WeekEnd)%>%"
"0","  mutate(`Store Nbr` = 99999)%>%"
"0","  mutate(`WM Week` = this_week$`WM Week`)%>%"
"0","  mutate(`POS Sales` = `Average Unit Retail`*`Net Units`)%>%"
"0","  mutate(`Curr Str On Hand Qty` = 0)%>%"
"0","  mutate(`Curr Instock %` = 0)%>%"
"0","  mutate(`Curr Str On Order Qty` = 0)%>%"
"0","  mutate(`Curr Str In Transit Qty` = 0)%>%"
"0","  mutate(`Item Flags` = """")%>%"
"0","  select(WeekStart, WeekEnd, `WM Week`, `Store Nbr`, `BRAND_NAME`, `CATLG_ITEM_ID`, `WM_ITEM_NUMBER (Dotcom)`, `Item Flags`, WUPC, `Net Units`, `POS Sales`, `Return Units`, `Curr Str On Hand Qty`, `Curr Instock %`, `Curr Str On Order Qty`, `Curr Str In Transit Qty`)-> onlineTransformed"
"0",""
"0","onlineTransformed%>%"
"0","  rename(`Brand Desc` = `BRAND_NAME`)%>%"
"0","  rename(`Vendor Stk Nbr` = `CATLG_ITEM_ID`)%>%"
"0","  rename(`Item Nbr` = `WM_ITEM_NUMBER (Dotcom)`)%>%"
"0","  rename(UPC = WUPC)%>%"
"0","  rename(`POS Qty` = `Net Units`)%>%"
"0","  rename(`Total Customer Item Return` = `Return Units`)-> online_clean"
"0",""
"0",""
"0","#remove time from date field"
"0","online_clean$WeekStart <- as.Date(online_clean$WeekStart)"
"0","online_clean$WeekEnd <- as.Date(online_clean$WeekEnd)"
"0",""
"0","#Create Online Data for skuByStore Merge"
"0","online_clean%>%"
"0","  mutate(Gross_Unit = `POS Qty`+`Total Customer Item Return`)%>%"
"0","  mutate(GrossPOS = Gross_Unit*(`POS Sales`/`POS Qty`))%>%"
"0","  rename(Return_Unit = `Total Customer Item Return`)%>%"
"0","  rename(Net_Sales = `POS Sales`)%>%"
"0","  rename(Net_Unit = `POS Qty`)%>%"
"0","  dplyr::select(WeekStart, `WM Week`, WeekEnd, `Store Nbr`, `Item Nbr`, UPC, Net_Unit, Net_Sales, Gross_Unit, Return_Unit, `Curr Str On Hand Qty`,"
"0","                `Curr Instock %`, `Curr Str On Order Qty`, `Curr Str In Transit Qty`, GrossPOS) -> skuByOnline"
"0",""
"0","#replace missing/infinite values with 0"
"0","skuByOnline$GrossPOS[is.na(skuByOnline$GrossPOS)] <- 0"
"0","skuByOnline$GrossPOS[is.infinite(skuByOnline$GrossPOS)] <- 0"
